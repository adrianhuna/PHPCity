!function t(e,i,r){function n(a,o){if(!i[a]){if(!e[a]){var h="function"==typeof require&&require;if(!o&&h)return h(a,!0);if(s)return s(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[a]={exports:{}};e[a][0].call(c.exports,function(t){var i=e[a][1][t];return n(i?i:t)},c,c.exports,t,e,i,r)}return i[a].exports}for(var s="function"==typeof require&&require,a=0;a<r.length;a++)n(r[a]);return n}({1:[function(t,e,i){"use strict";var r=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},n=t("./helpers"),s=t("./scene_manager"),a=function(){function t(t,e){this.name=t,this.parent=e,this.w=0,this.h=0,this.d=0,this.depth=null===e?0:e.depth+1}return t.prototype.getColor=function(){return this.color||(this.color=new THREE.Color(parseInt(n.colorLuminance(this.parent.getColor().getHex(),.3).substring(1).toUpperCase(),16))),this.color},t.prototype.setColor=function(t){this.color=new THREE.Color(t)},t.prototype.getX=function(){return null===this.parent?this.fit.x:this.parent.getX()+this.fit.x},t.prototype.getY=function(){return null===this.parent?this.fit.y:this.parent.getY()+this.fit.y},t.prototype.getTrackerText=function(){return this.name},t}();i.Block=a;var o=function(t){function e(e,i,r,n,s,a){t.call(this,i.name,e),this.parent=e,this.data=i,this.heightLevels=r,this.widthLevels=n,this.heightAttr=s,this.widthAttr=a,this.calculateBlockWidth(a,n),this.calculateBlockHeight(s,r)}return r(e,t),e.prototype.calculateBlockWidth=function(t,e){for(var i=0;i<5;i++)if(this.data[t]<=e[i]){this.w=i+2+2,this.h=i+2+2;break}},e.prototype.calculateBlockHeight=function(t,e){for(var i=0;i<5;i++)if(this.data[t]<=e[i]){this.d=4*(i+1);break}},e.prototype.render=function(t,e){var i={color:3120573};this.data["abstract"]?(i.color=3128747,i.opacity=.5,i.transparent=!0):"interface"===this.data.type&&(i.color=3944381);var r=new THREE.BoxGeometry(1,1,1),n=new THREE.MeshBasicMaterial(i);n.defaultColor=i.color,n.originalColor=i.color,r.applyMatrix((new THREE.Matrix4).makeTranslation(.5,.5,.5));var a=new THREE.Mesh(r,n);a.name=this.name?this.name:"",a.position.set(this.getX()-1*this.parent.addWidth+1,0+e/2+.05*e,this.getY()-1*this.parent.addWidth+1),a.scale.set(this.w-2,this.d,this.h-2),a.block=this;var o=new THREE.EdgesHelper(a,0);a.edges=o,s.SceneManager.objects.push(a),t.add(a),t.add(o)},e.prototype.getTrackerText=function(){var t="<em>&lt;&lt; "+this.data.type+" &gt;&gt;</em><br><strong>"+this.name+"</strong><br>";return null!==this.data["extends"]&&(t+=" extends <em>"+this.data["extends"]+"</em><br>"),null!==this.data["implements"]&&(t+=" implements <em>"+this.data["implements"]+"</em><br>"),t+("<br>Package: "+this.parent.getQualifiedName()+"<br><br>Methods: "+this.data.no_methods+"<br>Attributes: "+this.data.no_attrs+"<br>LOC: "+this.data.no_lines+"<br><br>File: "+this.data.file)},e}(a);i.Building=o;var h=function(t){function e(e,i,r){t.call(this,e,r),this.children=[],this.buildings=[],this.d=i}return r(e,t),e.prototype.render=function(t,e){var i=this.getColor().getHex(),r=new THREE.BoxGeometry(1,1,1),n=new THREE.MeshBasicMaterial({color:i});n.defaultColor=n.originalColor=i,r.applyMatrix((new THREE.Matrix4).makeTranslation(.5,.5,.5));var a=new THREE.Mesh(r,n);a.name=this.name?this.name:"",a.position.set(this.getX()-1*this.addWidth,0+e/2+.05*e,this.getY()-1*this.addWidth),a.scale.set(this.w-2,this.d/2,this.h-2);var o=new THREE.EdgesHelper(a,0);a.edges=o,t.add(a),t.add(o),s.SceneManager.objects.push(a),a.block=this,_.each(this.children,function(i){return i.render(t,e+1)}),_.each(this.buildings,function(i){return i.render(t,e+1)})},e.prototype.getWidth=function(){var t=new GrowingPacker;if(0===this.children.length){var e=this.buildings.length,i=_.sortBy(this.buildings,function(t){return t.w}).reverse();t.fit(i),this.w=t.root.w+2,this.h=t.root.h+2,this.fit=t.root;for(var r=0;r<i.length;r++)for(var n=i[r],s=0;s<e;s++)this.buildings[s].data.file===n.data.file&&(this.buildings[s].fit=n.fit)}else if(0!=this.children.length){for(var e=this.children.length,r=0;r<e;r++)this.childrenWidth();var i=_.sortBy(this.children.concat(this.buildings),function(t){return t.w}).reverse();t.fit(i),this.w=t.root.w+2,this.h=t.root.h+2,this.fit=t.root;for(var r=0;r<i.length;r++)for(var n=i[r],s=0;s<this.buildings.length;s++)n instanceof o&&this.buildings[s].data.file===n.data.file&&(this.buildings[s].fit=n.fit)}return this.w},e.prototype.childrenWidth=function(){for(var t=this.children.length,e=0,i=0;i<t;i++)e+=this.children[i].getWidth();return e},e.prototype.addBuilding=function(t){this.buildings.push(t)},e.prototype.addChildDistrict=function(t){this.children.push(t)},e.prototype.getQualifiedName=function(){return null===this.parent?"":"none"==this.name?"<em>No package</em>":this.parent.getQualifiedName()+"\\"+this.name},e.prototype.getChildBuildingsCount=function(){var t=_.reduce(this.children,function(t,e){return t+e.getChildBuildingsCount()},0);return t+this.buildings.length},e.prototype.getTrackerText=function(){return 0==this.depth?"<em>City base</em><br><em>Buildings:</em>"+this.getChildBuildingsCount():"<em>Package:</em><strong>"+this.getQualifiedName()+"</strong><br><em>Buildings:</em>"+this.getChildBuildingsCount()},e}(a);i.District=h},{"./helpers":2,"./scene_manager":7}],2:[function(t,e,i){"use strict";function r(t,e){var i=("000000"+t.toString(16)).slice(-6),r="#";e=e||0;for(var n=0;n<3;n++){var s=parseInt(i.substr(2*n,2),16),a=Math.round(Math.min(Math.max(0,s+s*e),255)).toString(16);r+=("00"+a).substr(a.length)}return r}i.colorLuminance=r},{}],3:[function(t,e,i){"use strict";function r(t,e){var i=d3.format(",.0f"),r={top:20,right:30,bottom:20,left:30},n=460-r.left-r.right,s=220-r.top-r.bottom,a=d3.scale.linear().domain([0,d3.max(t,function(t){return t})]).range([0,n]),o=d3.layout.histogram().bins(a.ticks(30))(t),h=d3.scale.linear().domain([0,d3.max(o,function(t){return t.y})]).range([s,0]),l=d3.svg.axis().scale(a).orient("bottom"),c=d3.select(e).append("svg").attr("width",n+r.left+r.right).attr("height",s+r.top+r.bottom).append("g").attr("transform","translate("+r.left+","+r.top+")"),d=c.selectAll(".bar").data(o).enter().append("g").attr("class","bar").attr("transform",function(t){return"translate("+a(t.x)+","+h(t.y)+")"});d.append("rect").attr("x",1).attr("width",a(o[0].dx)-1).attr("height",function(t){return s-h(t.y)}),d.append("text").attr("dy",".75em").attr("y",6).attr("x",a(o[0].dx)/2).attr("text-anchor","middle").text(function(t){return i(t.y)}),c.append("g").attr("class","x axis").attr("transform","translate(0,"+s+")").call(l)}i.histogram=r},{}],4:[function(t,e,i){"use strict"},{}],5:[function(t,e,i){"use strict";var r=t("./scene_manager"),n=t("./preprocessor"),s=t("./blocks");$(document).ready(function(){r.SceneManager.initialize(),$("input[type=file]").on("change",function(t){return n.processJSONInput(t.target)}),$('input[name="filter-type"]').on("change",function(t){for(var e=$('input[name="filter-type"]:checked').val(),i=r.SceneManager.objects.length,n=0;n<i;n++){var a=r.SceneManager.objects[n].block;a instanceof s.Building&&r.SceneManager.determineVisibility(r.SceneManager.objects[n],a,e)}}),$("#class-extends").on("change",function(t){$("#class-implements").val("");for(var e=$("#class-extends").val(),i=r.SceneManager.objects.length,n=0;n<i;n++){var a=r.SceneManager.objects[n],o=r.SceneManager.objects[n].block;o instanceof s.Building&&(a.material.color.setHex(o.data["extends"]==e?15641874:15641874==a.material.defaultColor?a.material.originalColor:a.material.defaultColor),a.material.defaultColor=o.data["extends"]==e?15641874:a.material.originalColor)}}),$("#class-implements").on("change",function(t){$("#class-extends").val("");for(var e=$("#class-implements").val(),i=r.SceneManager.objects.length,n=0;n<i;n++){var a=r.SceneManager.objects[n],o=r.SceneManager.objects[n].block;o instanceof s.Building&&(a.material.color.setHex(o.data["implements"]==e?15641874:15641874==a.material.defaultColor?a.material.originalColor:a.material.defaultColor),a.material.defaultColor=o.data["implements"]==e?15641874:a.material.originalColor)}}),$("#settings-form").on("submit",function(t){t.preventDefault(),r.SceneManager.preprocessor.processJSON()}),$("#demo-project-select").on("change",function(t){var e=$("#demo-project-select").val();$.getJSON("./data/"+e+".json",function(t){var i=new n.Preprocessor(t);r.SceneManager.preprocessor=i,i.processJSON(e)})})})},{"./blocks":1,"./preprocessor":6,"./scene_manager":7}],6:[function(t,e,i){"use strict";function r(t){var e=new FileReader;e.onload=function(e){var i;try{i=JSON.parse(e.target.result)}catch(r){return void alert("Could not parse input file. Did you upload valid JSON?")}var n=new o(i);s.SceneManager.preprocessor=n,n.processJSON($(t).get(0).files[0].name.split(".")[0])},e.readAsText($(t).get(0).files[0],"UTF-8")}var n=t("./blocks"),s=t("./scene_manager"),a=t("./histogram");i.processJSONInput=r;var o=function(){function t(t){this.json=t,this.heightLevels=[],this.widthLevels=[],this.jsonLength=t.length}return t.prototype.processJSON=function(t){s.SceneManager.cleanUp(),this.widthType=$('input[name="width-type"]:checked').val(),this.heightType=$('input[name="height-type"]:checked').val(),this.widthAttr=$("#width-attribute").val(),this.heightAttr=$("#height-attribute").val(),t&&$("#project-name").text(t),$("#project-objects").text(this.json.length),this.city={districts:{base:new n.District("base",1,null)},buildings:[]},this.detectLevels(),this.buildCity();var e=(this.city.buildings.length,_.size(this.city.districts),this.city.districts.base);this.city.districts.base.setColor(935015);var i=_.max(this.city.districts,function(t){return t.depth}).depth;_.each(this.city.districts,function(t){return t.addWidth=i-t.depth}),e.getWidth(),e.render(s.SceneManager.scene,0);var r=_.countBy(this.city.buildings,function(t){return t.data["extends"]});delete r["null"];var a=_.countBy(this.city.buildings,function(t){return t.data["implements"]});delete a["null"];var o=Object.keys(r).sort(),h=Object.keys(a).sort();$("#class-extends").find("option").remove().end().append("<option>-</option>").val("");for(var l=0;l<o.length;l++)$("<option/>").val(o[l]).html("("+r[o[l]]+") "+o[l]).appendTo("#class-extends");$("#class-implements").find("option").remove().end().append("<option>-</option>").val("");for(var l=0;l<h.length;l++)$("<option/>").val(h[l]).html("("+a[h[l]]+") "+h[l]).appendTo("#class-implements")},t.prototype.detectLevels=function(){var t=_.sortBy(this.json,this.heightAttr),e=t.length,i=this.json.length;"evenly"==this.heightType?this.heightLevels=[t[Math.floor(i/5)][this.heightAttr],t[Math.floor(i/5*2)][this.heightAttr],t[Math.floor(i/5*3)][this.heightAttr],t[Math.floor(i/5*4)][this.heightAttr],t[e-1][this.heightAttr]]:this.heightLevels=[Math.floor(t[e-1][this.heightAttr]/5),Math.floor(t[e-1][this.heightAttr]/4),Math.floor(t[e-1][this.heightAttr]/3),Math.floor(t[e-1][this.heightAttr]/2),Math.floor(t[e-1][this.heightAttr]/1)];for(var r=1;r<e;r++)if(this.heightLevels[r]==this.heightLevels[r-1])this.heightLevels[r]++;else if(this.heightLevels[r]<this.heightLevels[r-1])this.heightLevels[r]=this.heightLevels[r-1]+1;else if(!this.heightLevels[r])break;t=_.sortBy(this.json,this.widthAttr),"evenly"==this.widthType?this.widthLevels=[t[Math.floor(i/5)][this.widthAttr],t[Math.floor(i/5*2)][this.widthAttr],t[Math.floor(i/5*3)][this.widthAttr],t[Math.floor(i/5*4)][this.widthAttr],t[e-1].no_attrs]:this.widthLevels=[Math.floor(t[e-1][this.widthAttr]/5),Math.floor(t[e-1][this.widthAttr]/4),Math.floor(t[e-1][this.widthAttr]/3),Math.floor(t[e-1][this.widthAttr]/2),Math.floor(t[e-1][this.widthAttr]/1)];for(var n=1;n<t.length;n++)if(this.widthLevels[n]==this.widthLevels[n-1])this.widthLevels[n]++;else if(this.widthLevels[n]<this.widthLevels[n-1])this.widthLevels[n]=this.widthLevels[n-1]+1;else if(!this.widthLevels[n])break},t.prototype.buildCity=function(){for(var t=0;t<this.jsonLength;t++)this.createBlock(this.json[t]);$("#histogram-loc, #histogram-attributes, #histogram-methods").html(""),a.histogram(_.pluck(this.json,"no_lines"),"#histogram-loc"),a.histogram(_.pluck(this.json,"no_attrs"),"#histogram-attributes"),a.histogram(_.pluck(this.json,"no_methods"),"#histogram-methods")},t.prototype.createBlock=function(t){var e=this.buildDistricts(t.namespace),i=new n.Building(e,t,this.heightLevels,this.widthLevels,this.heightAttr,this.widthAttr);e.addBuilding(i),this.city.buildings.push(i)},t.prototype.buildDistricts=function(t){var e=this.city.districts.base;if(!t||""===t)return this.findOrCreateDistrict("none",1,e);for(var i=t.split("\\"),r=i.length,n=0;n<r;n++){var s=this.findOrCreateDistrict(i[n],1,e);e=s}return s},t.prototype.findOrCreateDistrict=function(t,e,i){if(void 0!==this.city.districts[t])return this.city.districts[t];var r=new n.District(t,e,i);return this.city.districts[t]=r,i.addChildDistrict(r),r},t}();i.Preprocessor=o},{"./blocks":1,"./histogram":3,"./scene_manager":7}],7:[function(t,e,i){"use strict";var r=t("./stats"),n=function(){function t(){}return t.cleanUp=function(){for(var e=0,i=this.objects;e<i.length;e++){var r=i[e];t.scene.remove(r),t.scene.remove(r.edges),r.edges.geometry.dispose(),r.edges.material.dispose(),r.geometry.dispose(),r.material.dispose()}t.objects=[]},t.initialize=function(){t.init(),t.animate()},t.init=function(){var e=window.innerWidth,i=window.innerHeight;t.renderer=new THREE.WebGLRenderer({antialias:!0,canvas:document.getElementById("canvas")}),t.renderer.setClearColor(13421772,1),t.renderer.setSize(e,i),t.renderer.domElement.addEventListener("mousemove",t.onDocumentMouseMove,!1),document.body.appendChild(t.renderer.domElement),t.camera=new THREE.PerspectiveCamera(45,e/i,.1,1e4),t.camera.position.set(70,70,150),t.scene.add(t.camera),t.scene.add(new THREE.AmbientLight(13421772)),window.addEventListener("resize",function(){var e=window.innerWidth,i=window.innerHeight;t.renderer.setSize(e,i),t.camera.aspect=e/i,t.camera.updateProjectionMatrix()}),t.controls=new THREE.OrbitControls(t.camera,t.renderer.domElement)},t.animate=function(){requestAnimationFrame(t.animate),t.renderer.render(t.scene,t.camera),t.controls.update(),r.stats.update()},t.determineVisibility=function(t,e,i){switch(i){case"all":t.visible=t.edges.visible=!0;break;case"abstract":t.visible=t.edges.visible=e.data["abstract"];break;case"final":t.visible=t.edges.visible=e.data["final"];break;case"interface":t.visible=t.edges.visible="interface"===e.data.type;break;case"trait":t.visible=t.edges.visible=e.data.trait}},t.onDocumentMouseMove=function(e){e.preventDefault();var i=54891,r={x:e.clientX/window.innerWidth*2-1,y:2*-(e.clientY/window.innerHeight)+1};t.raycaster.setFromCamera(r,t.camera);var n=t.raycaster.intersectObjects(t.objects),s=$("#tracker");n.length>0?(t.intersectedBlock!=n[0].object&&(t.intersectedBlock&&t.intersectedBlock.material.color.setHex(t.intersectedBlock.material.defaultColor),t.intersectedBlock=n[0].object,t.intersectedBlock.material.color.setHex(i),s.html(t.intersectedBlock.block.getTrackerText())),s.css({top:e.clientY+10+"px",left:e.clientX+10+"px",display:"block"}),document.body.style.cursor="pointer"):t.intersectedBlock&&(t.intersectedBlock.material.color.setHex(t.intersectedBlock.material.defaultColor),t.intersectedBlock=null,s.css("display","none"),document.body.style.cursor="auto")},t.objects=[],t.scene=new THREE.Scene,t.raycaster=new THREE.Raycaster,t}();i.SceneManager=n},{"./stats":8}],8:[function(t,e,i){"use strict";i.stats=new Stats,i.stats.showPanel(0),i.stats.dom.style.position="absolute",i.stats.dom.style.top="auto",i.stats.dom.style.left="auto",i.stats.dom.style.right="2px",i.stats.dom.style.bottom="26px",document.body.appendChild(i.stats.dom)},{}]},{},[1,2,3,4,5,6,7,8]);
//# sourceMappingURL=bundle.min.js.map
